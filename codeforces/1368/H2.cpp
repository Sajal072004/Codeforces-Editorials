// LUOGU_RID: 158582321
#include<bits/stdc++.h>
using namespace std;int n,m,q;char L[100010],R[100010],U[100010],D[100010];struct qq{int a[2][2];}t[4][400100];qq mul(qq a,qq b){qq c;memset(c.a,0x3f,sizeof(c.a));for(int k=0;k<2;k++)for(int i=0;i<2;i++)for(int j=0;j<2;j++)c.a[i][j]=min(c.a[i][j],a.a[i][k]+b.a[k][j]);return c;}void build(int p,int l,int r){if(l==r){for(int i=0;i<2;i++)for(int j=0;j<2;j++){int s=(i^(L[l]=='B'))+(j^(R[l]=='B'));t[2*i+j][p].a[0][0]=s;t[2*i+j][p].a[1][1]=2-s;t[2*i+j][p].a[1][0]=m+s;t[2*i+j][p].a[0][1]=m+2-s;}return;}int mid=(l+r)>>1;build(p<<1,l,mid),build(p<<1|1,mid+1,r);for(int i=0;i<4;i++)t[i][p]=mul(t[i][p<<1],t[i][p<<1|1]);}int tag[2][400100];void nm(int p,int o){tag[o][p]^=1;if(!o)swap(t[0][p],t[2][p]),swap(t[1][p],t[3][p]);else swap(t[0][p],t[1][p]),swap(t[2][p],t[3][p]);}void pd(int p){if(tag[0][p])nm(p<<1,0),nm(p<<1|1,0),tag[0][p]=0;if(tag[1][p])nm(p<<1,1),nm(p<<1|1,1),tag[1][p]=0;}void rev(int p,int l,int r,int x,int y,int z){if(x<=l&&r<=y)return nm(p,z);if(y<l||x>r)return;pd(p);int mid=(l+r)>>1;rev(p<<1,l,mid,x,y,z);rev(p<<1|1,mid+1,r,x,y,z);for(int i=0;i<4;i++)t[i][p]=mul(t[i][p<<1],t[i][p<<1|1]);}int S[2][401000],tg[2][400100];void bui(int p,int l,int r){if(l==r){S[0][p]=(U[l]=='B'),S[1][p]=(D[l]=='B');return;}int mid=(l+r)>>1;bui(p<<1,l,mid),bui(p<<1|1,mid+1,r);for(int i=0;i<2;i++)S[i][p]=S[i][p<<1]+S[i][p<<1|1];}void mm(int p,int o,int L){S[o][p]=L-S[o][p];tg[o][p]^=1;}void fd(int p,int o,int L){if(tg[o][p])mm(p<<1,o,(L+1)/2),mm(p<<1|1,o,L/2),tg[o][p]=0;}void up(int p,int l,int r,int x,int y,int t){if(x<=l&&r<=y)return mm(p,t,r-l+1);if(y<l||x>r)return;fd(p,t,r-l+1);int mid=(l+r)>>1;up(p<<1,l,mid,x,y,t);up(p<<1|1,mid+1,r,x,y,t);S[t][p]=S[t][p<<1]+S[t][p<<1|1];}int calc(){qq s;memset(s.a,0,sizeof(s.a));s.a[0][0]=S[0][1],s.a[0][1]=m-S[0][1];s=mul(s,t[0][1]);return min(s.a[0][0]+S[1][1],s.a[0][1]+m-S[1][1]);}int type[400100],lt[100100],rt[100100],ans[101000];char c[2];int main(){cin>>n>>m>>q;scanf("%s%s%s%s",L+1,R+1,U+1,D+1);build(1,1,n);bui(1,1,m);ans[0]=calc();for(int i=1;i<=q;i++){scanf("%s%d%d",c,&lt[i],&rt[i]);if(c[0]=='L')type[i]=0;if(c[0]=='R')type[i]=1;if(c[0]=='U')type[i]=2;if(c[0]=='D')type[i]=3;if(type[i]<2)rev(1,1,n,lt[i],rt[i],type[i]);else up(1,1,m,lt[i],rt[i],type[i]-2);ans[i]=calc();}swap(L,U),swap(R,D);swap(n,m);memset(tg,0,sizeof(tg));memset(tag,0,sizeof(tag));for(int i=1;i<=q;i++)type[i]^=2;build(1,1,n);bui(1,1,m);ans[0]=min(ans[0],calc());for(int i=1;i<=q;i++){if(type[i]<2)rev(1,1,n,lt[i],rt[i],type[i]);else up(1,1,m,lt[i],rt[i],type[i]-2);ans[i]=min(ans[i],calc());}for(int i=0;i<=q;i++)printf("%d\n",ans[i]);return 0;}