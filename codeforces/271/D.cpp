#include <iostream>
#include <vector>
#include <unordered_set>
#include <chrono>
#define ull unsigned long long

using namespace std;

ull prec[] = { 1,3449073762,1608297370,3392311503,75086866,1176813944,3698330094,1808223810,859239255,1337756164,3387544910,528883133,13544760,1823213346,3368619600,3585078149,1053466542,3112104131,583941387,3197787141,2341499323,2740500715,3524101975,1621801290,1603390695,1750763528,493716167,2947169432,2738366486,1581239080,2386952401,840322338,3621329475,3404165872,2998866484,3133436911,3152418014,29831525,1861152799,3713347996,40460862,1559838586,2111535278,3537177758,2850044810,1580884341,3020589717,3701049524,302377784,1240307568,2973136586,2281653820,3108931554,2503822139,325981294,817520005,2780855086,568225681,3402431986,940365721,2802023864,4023867538,2786250645,2733244969,1051201160,2483573616,475907480,1288475244,3250015271,2779614820,712316964,770132285,1481474752,1141191240,1221778843,535984014,2597706005,3164772610,2201052841,2284502651,1865733145,3476600775,2784742246,2899953105,1777874536,514511542,1234125255,2743319375,3705402034,3751816726,3264098891,459562240,1884537922,3976362494,1939207843,3921284374,2406131963,1696847088,3288354794,1914705114,2934164919,1097547359,1137508809,1043397013,1989284712,2753236613,776152550,464810188,3115334256,3314017620,1885524356,1290790818,2349353066,1381300064,1967792606,2555154610,2869290225,2784322809,1890218940,2282650739,3237701928,1717714852,1370299576,1209761444,2483587884,1655268187,3441926944,1270137935,3891311524,269563954,3074825181,2244819348,1794960636,2599278447,3516428712,353796327,1834552402,1978777042,2795551115,1741021519,2502604683,3998305411,3825895116,1240989419,896031835,2901971880,143622951,3945928406,759114822,3070491773,3189985549,1067657735,3570279564,3144796768,150575780,710256449,3961665293,183115448,902867621,427977968,1856811166,1114960254,2973490095,3713083301,342140796,681455408,3372529531,601839450,3154378939,2083590060,2130186613,2915944892,2365549992,3433965515,3333380074,692668224,3324378479,3520871420,3568676374,509565650,3508944903,1028654084,1742686467,1236424502,1440660417,699793675,3021240009,3381494996,3458132965,3625942498,2222252063,1355753443,1337071266,3827114799,582911362,4032422772,2663317744,824661308,2342380143,226744338,3325430918,2489250087,355163050,2881495063,1268263563,850800535,390764872,3259783776,523035023,2640749864,3510231042,861945928,950715978,3470681824,1752390709,1797105055,3352931352,1412762168,1226910317,2967298767,3441315430,3739754947,2203658099,170919239,795253963,2990241590,2844523769,394592160,3894151045,3088648507,1825314000,2108640860,2088238208,3130801450,1721353116,3492638470,2450597569,1931045204,3766613383,3796691200,3851776946,310781479,331255779,1326400215,2122093134,1540692119,2890721451,2858741559,326742808,1609110773,1911635701,2764173276,2943725855,3631003246,355995367,1938517277,2882002329,3835643951,1653930698,140957128,1896912056,2236323222,3553239674,3961921118,1326362131,1832451188,1410436618,3610072338,1244982670,2383639048,2858331141,993575858,2519317688,1109183256,3456104550,2164235434,944266974,2701342633,2819327377,2648252262,1298520007,133994168,3068611580,2022297901,3782307493,3621958997,2162791205,1841281374,3866557311,3596066606,1652085198,2988494750,3491293340,3188199473,906785916,2050192072,886620154,183933106,139000909,3451275000,1996797151,284714587,2306947087,3974941351,1590105273,581250912,930627361,3143829663,3715287359,1829747848,720256834,681854221,288608934,3577140440,3535120910,1595537521,3548804553,991449260,2586073763,3657965400,1262496820,1369893825,695409847,1508097577,2319095188,1875585543,3710430988,3889342383,1390558348,671335676,2324126929,2801783593,556189549,741299957,294815685,3731811255,3191504211,152768713,1347906666,1521288672,3823118704,350176041,2869456599,2344388085,3560545165,3648933379,1642240670,2098775101,3433576721,3250937874,1078606870,2675089961,2280167847,3928610822,3422797728,3035711783,3108269831,568984720,1180871059,457915628,585161704,150345452,3557429428,610246220,3163499404,202012619,2662243489,1167927040,1329029021,3108481044,1189854495,2597400055,3566769334,1078635290,2222752421,2449753722,3742219240,990007511,3472144513,316219143,3144139164,110084215,2081127390,2764553316,3228260795,3379689683,3529266529,2599434508,1634485676,128917363,3387436133,305997447,4049542906,1949793290,184758352,3068616148,3963701451,776991050,1668611788,578704458,2065483660,1213107095,1728841108,2488741630,588262754,33613462,3006223741,1970857131,3792881726,163766478,3147773329,403374368,2540787091,1979570169,1600504582,52673542,107252512,1679495172,2507341395,3888869335,2301070004,992431348,1521621473,3318981247,3798839650,2969354143,3133069467,1831519399,1092341101,213134685,235672447,3404226003,2096015346,1995216045,2455934649,3095450068,107161527,3601200143,886759721,1611349896,1331987229,4047081711,2332456038,1208388870,1184576479,1303130547,777481216,1107567364,1105773125,441493395,948854202,3447699991,2684787640,3507316698,2868281540,320907053,3021205915,1930002185,3122032291,3720027646,217019020,438495114,2753461854,1792817676,3163241029,868116106,3113911394,798437094,2691115437,1983596368,392690748,1757585562,957362762,1340318512,1038308226,889812195,2624367393,2750375454,3119917382,4045783444,198808916,3902158771,4008645423,2463776382,1037314955,3752671004,442461152,323607073,979850603,233917498,3318500585,525593825,470624255,622006470,2236208500,3176778096,1695457281,2277890965,2239275811,1754103843,154828099,3996999782,3195905534,1016587900,1502654653,2602535239,3922073640,1375240183,936170633,1306026501,1565789081,2350836965,2303485123,1793871550,1749321515,2950200724,673664750,906194858,767961001,1189643884,2725805532,1464870469,1033212397,2338751026,3441988447,1603554484,4019382234,4009385548,3758410270,1630212506,317877339,3346232054,2761384061,2616145674,240995718,1442029997,737002209,101842266,412949566,1774732437,1809509869,431342647,1606566667,1793808838,2941449807,205275733,2222673832,2682123888,1530893228,2829436128,884501544,1196220561,2980793174,2822270830,1020202162,3502059874,2657433406,3546346589,1180044611,2927897409,606176900,2027912933,1104761577,2616726180,2746726883,4034441424,2451740688,1022357550,2164016434,3479910711,4002041237,3000379437,1213920798,1227622001,1199899320,2521524984,2222882259,1909502201,1782527659,528738706,2988393666,210386994,3321051986,3177605292,856808960,1257137722,73800368,3617247828,2764326755,1955879042,1968573886,3422986143,978305558,1968121131,1873730019,586748259,2188782843,1864994955,3432096531,857561437,3151118855,2280940259,977838003,745715359,3139800352,2059877506,1661066673,3387574003,2476488087,177874768,2320799430,2822576229,1454300315,2201263713,2400140574,2128391156,1112795962,1996951512,960302608,300307217,3233875664,1994224070,3874596417,1566020213,3750165061,1480283756,2015953574,2011624316,2317316556,3316499329,3210435833,2299549802,933335500,3894564312,2196741051,2055415185,3126056248,462468125,29954259,829166594,279137693,991155040,2772845367,1046462475,2647684,3028108255,1483501877,418180931,3389286104,1312813434,1546820698,2409566181,2071485023,508701349,3808436053,3531858628,1508352814,2353385315,1683345173,475105895,2030454657,2769655793,2403839604,353696211,903247759,2248636611,1116819454,261653737,2885134532,230441061,2329194292,1249609659,2611267389,76110949,2428038045,1898941800,2564268123,1803014725,3069491343,2341122990,2194412535,2457411727,2625602818,3624773218,3458884433,3644546771,3214478024,1413479286,579775865,1342473265,2694447487,2024452962,1579350897,1483371511,45367235,3431568004,2454239957,2923634607,1403239041,3152627111,3471609539,1336532084,27479393,3805839232,2584138285,3404437329,3288508451,2724170456,3776169249,3965953850,1381080745,2853863466,1599488890,3292358705,1720638077,3427706081,3264069726,1520001944,3485689373,2465918054,1132889693,2399314860,2535494870,1941266917,687071130,920787598,2609049070,1283195369,3386080847,1938425150,2291409997,1952918180,878221269,2608315663,2868565432,3710520341,3936400087,1138493839,260196534,2368229322,731978516,317066935,3064615382,3277534222,3174318281,2529727995,1218620695,3552783308,1366087244,2601428585,3280410849,1873848105,1406062883,2820669975,941042948,222240779,2716598772,2337808140,1554573487,220836834,2978151886,2839050856,1480566558,3873820619,1164388180,1056531812,3741729083,161573145,1204180852,39870287,30281020,874765166,2738909578,3957835169,18960350,1889240523,535679287,1114476584,2852015534,3803904667,1460225233,2242850117,595171606,1389167558,2329663348,2710587006,3333314981,2827044800,2152140813,3330711211,880169191,518443434,426119434,3094537839,2841250059,292451130,3426483201,3821830989,1046921656,2667791343,911846124,2474806156,521870022,2240212161,139550731,1450046212,3630139261,65623770,1873194035,336503409,302804603,811681306,1067443724,705961493,1533268922,3625039713,926159007,924821784,2951585685,1672820140,2408483154,1341908244,3111765298,853155152,3518825106,3869626571,3063840693,1023871783,369622722,798190150,1557718040,2478512158,2051063080,2012357052,1176258692,2160017611,3259213405,1715892846,3493002767,1807475757,2868858157,3710155579,2047890814,2312577571,3910009533,1632779666,2328226116,3952691177,94835862,10952184,3586599952,1677619530,1401302977,580504346,3538499142,1203755147,3700156460,1758612760,3257353343,2829591483,346073967,603391057,1358526077,838770642,2491579844,3396768445,709818980,23775115,1419028785,2653962870,945405407,2303723444,922027437,1273559066,2280406519,1567700702,3968308640,1222762817,1980545932,3195724084,2503829949,3528093350,2659989267,490150100,3236081477,90393918,911978986,1267356760,1435920952,3780065998,3754376963,711675101,2866935610,2500517268,443078054,2472575244,950860910,3158058229,722929880,165314171,1140343229,4032108144,1893979105,450684030,3171145601,1883687558,2955684640,1255502647,1780280079,50500989,1145075146,1442840927,3141322236,2340399877,497781897,2496656197,791450572,1122524943,2857123295,1583073708,3772053896,2330607348,3775769046,484778678,621278167,1837494778,3118011295,3875062329,3302412757,3189641630,541997705,792733836,690615663,3701934227,534018460,3065364481,1034450782,715443021,1017094273,951824304,2274176166,2596038474,1875975252,1712850069,3532399634,722963565,1700343512,413458195,2913966471,1565933771,2464286152,1239772530,2162941633,1635175975,499177591,2255166441,2673736680,3364318674,3961904118,2578315715,230413452,2794299424,55699272,1369055655,2595957027,3722898614,102110951,3003311598,2447270442,3977142708,2975206801,2381970800,1458273339,2715615631,3815565620,2883630388,1113958287,3390078290,1707514490,2606566345,2316640515,2066004836,2574862018,513853682,1979387776,1833239527,1609611123,3790295701,410727952,1345376360,1865648638,3440851510,1209947762,3917206080,754369989,1597476026,1320677542,2610179419,1248175790,847150844,1702543417,301103584,455282944,1937067058,2465049125,3348978785,595635929,3410459796,137102517,3066787918,359957268,393274222,980951237,1490613431,1565805691,1852536093,969044533,3031478311,343173827,1958579482,1298457947,211694079,3029221431,1932921213,1814266352,1427944822,3047570292,3332980516,330798154,2119814815,1443293427,817620546,2059303757,2770752754,3627704586,1900508905,3936602002,2617710579,2538432829,3050953314,337338966,1830173461,2718206,984199188,2017003299,632359694,227320039,1291735970,3932534550,2716203065,3806081176,3608828756,292155412,1560226023,4047102249,1686051100,1300986942,2276031527,2957908675,873204666,3674956320,694158114,901819242,2553234747,3936295949,453786114,1970992239,2215901741,1295198007,2500740624,2399802734,1788408392,1239346923,3305458678,2874829566,2909080920,1596575552,880742722,1534743803,2265838488,1955104609,2983050192,2899241373,145446647,1259992017,2075759039,3487198536,2361223936,815879204,1602953386,2389143085,3661960351,192572976,3108013992,3839312172,2058481298,629809908,1834577239,3814391975,1017373131,473222026,2644393265,3958921029,2092782165,3070976571,2129545886,3046174272,2104738047,1149637456,697213969,183551274,1300851740,3951504364,640559113,2900489738,2728148212,281132514,2633797118,1138741413,1423506575,1627448882,3882223968,2774199884,2376116099,1417416518,990527891,3856631471,3980552624,2247454368,2394308117,3362469588,2804065758,1453933861,2085625776,2497163867,2245496944,3054939626,2885385885,2178046035,2558821413,1482000495,995275951,3500963266,2788757110,2183509165,3788158613,687237322,1102816995,3449537787,1440494775,286488470,2995667634,150927149,3262680501,1193516254,3390085449,1365343027,3351798135,1002739971,445132007,3396584296,884917367,2973834183,3371641445,3311122377,783498518,349172945,1018885256,715076832,2780116291,1588903392,1389621767,112844642,2470356798,1946003304,2556976591,3705385266,2518102556,1828910543,2404484528,3588639275,1456557979,738827458,2688921343,2217425497,390523059,27759055,3519845198,2833627775,3915893033,3066763163,1629785480,273373123,699688637,3452055030,810505537,2806754427,1473267885,3339405043,439870446,2111434498,2870344662,1384265252,1371728724,330256883,1026544109,1556279435,3089167711,4045780677,3529326467,863771588,2244620387,1446952541,69075200,2498806350,3644825167,2443680285,612699518,3551269631,3354183565,3586171215,2735870468,3605084570,2200727674,2983801871,971699848,4015312705,3610306737,946221040,2022836495,2419093512,3331100021,3447184780,1541905722,2651785197,1482738437,1040874560,3851893753,400154633,3328364829,3355257872,169563712,2248935379,2806154287,133035467,3261584526,3594188226,2552382654,2743437998,4048303085,506325714,3813542876,1086318051,3285381549,2758825067,3348640432,2431980406,1420704640,309833143,2946788097,3293209518,2788373627,590113658,235341581,1104600273,1366961310,2765583417,1020197061,3671686452,3811638980,1379972494,3281760090,3815251776,2241602880,884448648,383472133,1424168189,571386695,2040312606,2276098055,441233918,3287147443,3106833303,1677211570,3201533402,2140136496,2180167704,4034025654,1049859057,739520438,3096389982,3642325422,609889071,2009673850,2587624541,574409695,469899071,2906675783,3791506782,1261779260,1790129929,884043234,2793628664,3277145049,1246411865,1454888061,4021192798,2231407338,1641748326,2440581732,2598242178,2613212687,4013271686,3969623069,2206232302,3081930430,2063520182,2783155937,2070059487,1829964591,1153260614,1741968103,1464052362,1750021413,2836751613,363949240,1150939965,3302532416,1239483171,1396521303,1051810452,2083400861,6388876,3911625953,842283477,1914485005,3267946231,2509308273,1257651210,1469480606,2185214392,856719660,1585812009,433876036,1395719234,2645935429,1534537855,3632335594,3695997535,2996339226,456619839,3704101901,3228345340,701778481,1357075777,765448055,1457398300,3225954441,1951178333,235464056,2672825361,2988586601,748449814,3055169703,1853764478,3182215507,3479637545,3605516286,3368779980,196559266,2746509105,1235785254,2953802397,3529592994,3300192940,2343697268,282921861,2731195766,1446631537,374038224,3969660382,2613700882,3706119947,632876477,3259440774,761606567,3108794773,2469896811,297889539,1577371591,834777663,2702791934,3076868076,2334922252,1604549230,904819470,2848713573,3286999291,1014407367,810286186,2777571340,1752693128,609719033,1027298833,2475910910,3068092740,2611795813,4021296902,3210499254,2003341675,763317479,3535962074,956793212,551646068,733638993,3304318807,1415311312,2793676470,1660403127,1379049339,2369789155,1874860528,1074105584,1582183687,1177314348,1294010185,1171087015,20533527,3627092320,1104175902,869389975,1399406307,548038013,2580926826,1213153477,1949173270,2855373739,3091838128,418690445,323604934,1496026105,1840856587,3632363158,2070500691,733046090,3092741516,1859239684,1677464094,2283361171,625817472,1994354173,1159112020,146384427,2287236069,625088244,1616068598,1203946946,2150900394,2772584938,3519727402,934174874,3492567636,2665093107,2291475386,3217274575,3801019228,1557258672,3459427965,3403786515,3119976179,3246896983,2155096900,2006529800,147919835,3750402242,940397033,440748937,1520477465,2744074719,2595351181,3617474729,1092866598,2912568454,101308457,2196399716,3479913625,948762825,3278802981,3018918562,1120536651,842397110,154381271,1326384299,426921713,159086133,605562961,3674567448,3194782155,1511240789,806683010};

 ull expMod(ull b, ull exp, ull mod) {
	if (exp == 0) {
		return 1;
	}
	ull tmp = expMod(b, exp / 2, mod);
	if (exp % 2 == 0) {
		return tmp * tmp % mod;
	}
	else {
		return tmp * tmp % mod * b % mod;
	}
}

 namespace std {
	 template <> struct hash<std::pair<ull, ull>> {
		 inline size_t operator()(const std::pair<ull, ull>& v) const {
			 std::hash<ull> int_hasher;
			 return int_hasher(v.first) ^ int_hasher(v.second);
		 }
	 };
 }

int main() {

	ull m = 500009, p = 53;
	ull m2 = 4053892831, p2 = 11113;

	string s, chr;
	int k;

	cin >> s >> chr >> k;

	int n = s.length();
	vector<ull> dp(n);
	
	dp[0] = chr[s[0] - 'a'] == '0';
	for (int i = 1; i < n; ++i) {
		dp[i] = dp[i - 1] + (chr[s[i] - 'a'] == '0');
	}


	vector<ull> dp2(n);
	vector<ull> dp3(n);
	dp2[0] = s[0];
	dp3[0] = dp2[0];
	for (int i = 1; i < n; ++i) {
		dp2[i] = (dp2[i - 1] + (ull)(expMod(p, i, m) * s[i]) % m) % m;
		dp3[i] = (dp3[i - 1] + (ull)(expMod(p2, i, m2) * s[i]) % m2) % m2;
	}
	unordered_set<pair<ull, ull>> st;
	for (int j = 0; j < n; ++j) {
		if (dp[j] <= k) {
			st.insert(pair<ull, ull>(dp2[j], dp3[j]));
		}
	}
	for (int i = 1; i < n; ++i) {
		ull tmp = expMod(expMod(p, i, m), m - 2, m);
		for (int j = i; j < n; ++j) {
			if (dp[j] - dp[i - 1] <= k) {
				st.insert(pair<ull,ull>((dp2[j] - dp2[i - 1] + m) % m * tmp % m, (dp3[j] - dp3[i - 1] + m2) % m2 * prec[i] % m2));
			}
		}
	}

	cout << st.size() << "\n";

}
			 		 	    		  			  	  				  	