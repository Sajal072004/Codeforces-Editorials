// LUOGU_RID: 160598594
#include<algorithm>
#include<cstdio>
#define mod 998244353
#define ll long long
#define MaxN 255
using namespace std;inline int read(){int X=0;char ch=0;while(ch<48||ch>57)ch=getchar();while(ch>=48&&ch<=57)X=X*10+(ch^48),ch=getchar();return X;}ll powM(ll a,ll t=mod-2){ll ans=1;while(t){if(t&1)ans=ans*a%mod;a=a*a%mod;t>>=1;}return ans;}ll fac[MaxN],ifac[MaxN],s[MaxN][MaxN];ll C(int n,int m){return fac[n]*ifac[m]%mod*ifac[n-m]%mod;}void Init(int lim){fac[0]=1;for (int i=1;i<=lim;i++)fac[i]=fac[i-1]*i%mod;ifac[lim]=powM(fac[lim]);for (int i=lim;i;i--)ifac[i-1]=ifac[i]*i%mod;s[0][0]=1;for (int i=1;i<=lim;i++)for (int j=1;j<=i;j++)s[i][j]=(s[i-1][j-1]+s[i-1][j]*(i-1))%mod;}void get1(ll *F,int n,int m){if (!m){for (int k=0;k<=n;k++)F[k]=s[n][k];return ;}for (int k=0;k<=n;k++)for (int i=k;i<=n;i++)F[k]=(F[k]+C(n,i)*s[i][k]%mod*fac[n+m-i-1]%mod*ifac[m-1])%mod;}int n,p1[MaxN],p2[MaxN],tp[MaxN],f[MaxN];int findf(int u){return f[u]==u ? u : f[u]=findf(f[u]);}void merge(int u,int v){f[findf(u)]=findf(v);}ll F[MaxN],G[MaxN],H[MaxN];bool v1[MaxN],v2[MaxN];int main(){Init(n=read());for (int i=1;i<=n;i++)f[i]=tp[p1[i]=read()]=i;for (int i=1;i<=n;i++)p2[i]=read();int cnt=0;for (int i=1;i<=n;i++)if (p1[i]&&p2[i]&&!v1[p1[i]]){int p=i;v1[p1[i]]=1;while(1){if (p2[p]&&tp[p2[p]])p=tp[p2[p]];else break;v1[p1[p]]=1;merge(p1[p],p1[i]);if (p==i){cnt++;break;}}}for (int i=1;i<=n;i++){p1[i]=findf(p1[i]);p2[i]=findf(p2[i]);}int n2=0,n3=0,m=0;for (int i=1;i<=n;i++)v1[i]=0;for (int i=1;i<=n;i++){if (!p1[i])v2[p2[i]]=1;if (!p2[i])v1[p1[i]]=1;}for (int i=1;i<=n;i++)if (v1[i]&&v2[i])m++;for (int i=1;i<=n;i++)if (p1[i]&&!p2[i]&&!v2[p1[i]])n2++;else if (!p1[i]&&p2[i]&&!v1[p2[i]])n3++;else if (!p1[i]&&!p2[i])m++;get1(F,n2,m);get1(G,n3,m);for (int i=0;i<=n2;i++)for (int j=0;j<=n3;j++)H[i+j]=(H[i+j]+F[i]*G[j])%mod;for (int i=0;i<=n;i++)F[i]=0;for (int i=0;i<=m;i++){ll sav=s[m][i]*fac[m]%mod;for (int j=0;j<=n2+n3;j++)F[i+j]=(F[i+j]+sav*H[j])%mod;}for (int i=0;i<n;i++)printf("%lld ",n-i-cnt>=0 ? F[n-i-cnt] : 0);puts("");return 0;}