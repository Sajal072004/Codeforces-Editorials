#include<bits/stdc++.h>
using namespace std;
struct ds{int a[1000],b[1000000];ds(){memset(a,0,sizeof(a));memset(b,0,sizeof(b));}void add(int p){b[p]++;if(b[p]==1)a[p/1000]++;}void del(int p){b[p]--;if(b[p]==0)a[p/1000]--;}int qry(){for(int i=0;i<1000;i++)if(a[i]!=1000)for(int j=i*1000;;j++)if(!b[j])return j;return 1000000;}}ds0,ds1;int n,m,k,t,ans;vector<int>v[40004];int I(int x,int y){return (x-1)*m+y;}bool check(){return ds0.qry()+ds1.qry()+1>=t;}void add(int i){for(auto w:v[i]){if(w>0)ds0.add(w-1);if(w<0)ds1.add(-w-1);}}void del(int i){for(auto w:v[i]){if(w>0)ds0.del(w-1);if(w<0)ds1.del(-w-1);}}void sol(int a,int b){add(I(a,b));int c=a,d=b;for(;;){while(!check()&&c<n&&d<m){c++,d++;for(int i=a;i<=c;i++)add(I(i,d));for(int i=b;i<d;i++)add(I(c,i));}if(!check())break;ans+=min(n-c+1,m-d+1);if(a==n||b==m)break;for(int i=a;i<=c;i++)del(I(i,b));for(int i=b+1;i<=d;i++)del(I(a,i));a++,b++;if(c<a)c++,d++,add(I(c,d));}for(int i=a;i<=c;i++)for(int j=b;j<=d;j++)del(I(i,j));}int main(){scanf("%d%d%d%d",&n,&m,&k,&t);while(k--){int x,y,w;scanf("%d%d%d",&x,&y,&w);if(abs(w)<=1000000&&w)v[I(x,y)].push_back(w);}for(int i=1;i<=m;i++)sol(1,i);for(int i=2;i<=n;i++)sol(i,1);printf("%d",ans);}